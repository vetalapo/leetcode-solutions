using BenchmarkDotNet.Attributes;
using BenchmarkDotNet.Order;

using Problems;

namespace Benchmarks;

[MemoryDiagnoser]
[Orderer( SummaryOrderPolicy.FastestToSlowest )]
[RankColumn]
public class ReverseLinkedListBenchmarks
{
    private static readonly ReverseLinkedList ReverseLinkedList = new();

    private static readonly int[] Input =
    {
        1262, 1, 4273, 2, 6698, 3, 3754, 4, 8936, 5, 2184, 6, 2560, 7, 4953, 6982, 50 ,1199, 7288, 9026, 15, 824,
        9159, 7967, 1365, 8970, 8322, 3513, 2122, 7736, 9957, 30, 997, 5202, 4352, 1212, 3241, 1305, 4362, 2470,
        2963, 7303, 3776, 1097, 8692, 4018, 1601, 6053, 1806, 8160, 1664, 9000, 7315, 1803, 9577, 2675, 6935, 88,
        501, 1576, 3752, 2864, 4417, 3174, 2950, 2254, 5667, 3829, 1213, 8655, 6398, 6594, 5114, 5303, 3508, 9821,
        8672, 44, 317, 5436, 7031, 5242, 3091, 11, 728, 2423, 2996, 8769, 9527, 5351, 5801, 6977, 7312, 8380, 1597,
        5092, 8929, 3828, 5157, 4083, 6792, 3739, 1, 695, 2482, 5829, 2475, 6624, 2126, 5971, 21, 431, 3234, 3431, 99,
        368, 1231, 4694, 7057, 9276, 3826, 4524, 9938, 1324, 2076, 7789, 1214, 5622, 2577, 6377, 2321, 2397, 4286,
        6684, 6401, 7, 587, 1221, 4720, 6943, 1751, 2273, 6784, 65, 215, 7230, 5986, 1435, 7807, 4654, 8186, 712, 9896,
        4687, 5172, 5695, 5283, 5073, 1349, 6755, 6428, 4948, 9778, 2783, 1244, 9603, 3714, 7075, 7022, 934, 3160, 2173,
        1460, 8486, 1603, 8078, 6855, 1994, 144, 6881, 2381, 2605, 5708, 5499, 6063, 8694, 5230, 128, 6093, 4301, 9254,
        9764, 6007, 6326, 2210, 8497, 1263, 6538, 3274, 8240, 6235, 3631, 4776, 3928, 724, 2179, 6850, 857, 588, 9379,
        9742, 6187, 5858, 1367, 546, 3288, 7108, 6871, 8438, 9942, 6566, 1945, 7929, 7074, 9766, 4612, 2187, 7422, 7343,
        253, 5700, 9933, 7378, 7622, 6108, 9919, 5038, 3744, 9620, 7595, 4013, 316, 1639, 8271, 3598, 7106, 8417, 7505,
        2000, 4489, 8849, 9173, 6625, 5555, 7249, 4146, 9263, 2127, 4770, 7152, 3384, 2186, 2891, 3529, 3322, 2125, 5840,
        4923, 5863, 8100, 9677, 9846, 376, 1866, 8278, 3638, 2928, 327, 5597, 4151, 491, 7299, 4808, 2077, 7965, 9339,
        2428, 2676, 2214, 5898, 6854, 925, 4003, 7761, 7785, 5575, 480, 7228, 4960, 5905, 9686, 7202, 6130, 9622, 6003,
        6990, 5899, 9935, 5835, 5445, 2317, 1219, 3637, 6948, 3204, 1792, 5505, 1316, 9430, 9134, 800, 4232, 4135, 4064,
        3559, 471, 5709, 9258, 882, 9555, 2630, 7340, 1880, 7824, 6320, 5533, 8621, 6464, 5818, 8551, 7997, 7674, 6547,
        2846, 3152, 2119, 5605, 9240, 8047, 4077, 7225, 6092, 7726, 6295, 7532, 3995, 7954, 2862, 6587, 5125, 2330, 3192,
        727, 883, 6951, 6029, 524, 100, 3780, 5367, 1126, 9790, 6722, 1508, 2326, 8225, 4979, 9568, 4231, 7200, 9480, 1171,
        6105, 9533, 9674, 7679, 8516, 6129, 7585, 9038, 1659, 1392, 8871, 3957, 1483, 3977, 6415, 3260, 2951, 3952, 1767,
        1362, 3122, 477, 191, 6088, 9625, 6515, 3348, 2264, 1002, 3993, 7481, 7771, 6120, 8169, 845, 7311, 1456, 3335,
        7648, 4396, 9791, 2529, 821, 3033, 7589, 9651, 4041, 9416, 6229, 8990, 5260, 9583, 6327, 1419, 1076, 1755, 6798,
        6010, 3986, 970, 7527, 1557, 6776, 7974, 65, 5379, 3307, 7555, 9890, 938, 6454, 3725, 6161, 5782, 9099, 5023,
        646, 1716, 3528, 8300, 5164, 2640, 9908, 5671, 7489, 4635, 4036, 5701, 262, 957, 1850, 4370, 5834, 338, 8867, 2958,
        7, 4382, 7446, 4562, 7551, 2972, 6927, 5628, 3784, 4976, 350, 4421, 5531, 2436, 1257, 8671, 2692, 4477, 4965, 8824,
        9999, 9365, 5563, 6155, 1354, 5804, 5705, 8765, 1416, 4791, 6457, 9575, 9290, 7714, 2530, 9733, 5321, 96, 6564,
        6893, 7716, 8416, 312, 806, 1117, 8085, 5279, 3290, 3218, 156, 3695, 7046, 6803, 7297, 4467, 9359, 1496, 4307,
        1136, 6809, 4797, 3805, 7169, 7243, 2290, 9739, 2484, 7181, 9835, 4735, 6073, 63, 9104, 2176, 1310, 6225, 6146,
        4947, 3417, 1472, 8048, 4225, 6317, 6381, 8667, 7921, 6115, 9230, 6617, 7784, 5583, 2002, 7526, 1702, 6885, 6651,
        9543, 3004, 1374, 3858, 7290, 5120, 1503, 7823, 2479, 8390, 6427, 7941, 4970, 9697, 398, 6668, 8940, 1575, 619,
        7133, 60, 3683, 4964, 2414, 4499, 3456, 8288, 7972, 8935, 6541, 6019, 9397, 7199, 8307, 147, 3116, 6406, 5437,
        309, 3703, 2350, 7657, 5981, 504, 6074, 799, 8959, 1469, 7669, 8012, 4425, 7268, 5579, 8496, 4538, 8232, 1976,
        4855, 7335, 4563, 8399, 6325, 7919, 5908, 7517, 6984, 5102, 9089, 9977, 2465, 5359, 1366, 7888, 7194, 9724, 2907,
        4594, 1734, 216, 4706, 6555, 7676, 7704, 7400, 9296, 6662, 9786, 2933, 9336, 2370, 8533, 279, 5959, 2134, 6717,
        3094, 1245, 3446, 1704, 3113, 3632, 412, 3451, 4324, 9023, 386, 6501, 50, 5371, 7692, 3923, 5468, 2160, 4020,
        357, 9256, 6400, 748, 4371, 438, 6266, 9407, 3009, 7636, 4667, 9883, 1394, 8203, 8196, 2995, 455, 3259, 8768,
        5987, 4901, 6487, 3942, 6178, 7591, 5219, 3545, 497, 758, 2726, 2920, 3842, 9155, 8642, 9475, 4330, 8003, 967,
        731, 4217, 1538, 3032, 652, 6138, 9464, 5600, 648, 6796, 1727, 2918, 6363, 4680, 362, 6690, 3304, 7393, 4975,
        6158, 1155, 8231, 4023, 8934, 2118, 4956, 7130, 2367, 7924, 2847, 8903, 7344, 8874, 539, 3853, 1335, 3014, 7865,
        232, 2740, 899, 5152, 834, 2427, 9820, 2195, 8942, 3885, 1148, 4473, 8044, 4620, 3359, 6058, 2285, 5291, 4403,
        3688, 757, 1732, 5707, 8529, 1177, 3563, 1955, 561, 2422, 1145, 1275, 8520, 4033, 8850, 6258, 7255, 1217, 5155,
        4867, 2655, 5689, 7713, 8394, 2887, 3087, 4851, 7420, 7799, 1781, 949, 8676, 2690, 5277, 8785, 3153, 8243, 3491,
        1294, 1037, 5214, 1099, 6207, 4432, 6201, 720, 8612, 5608, 3128, 9242, 4257, 5974, 36, 2885, 5982, 578, 9832,
        7949, 4466, 9036, 5078, 9113, 7405, 9482, 5985, 6534, 380, 1784, 9091, 9961, 3983, 5769, 9014, 2156, 1372, 9343,
        7646, 8507, 7717, 7179, 6816, 3630, 5773, 8005, 3560, 2889, 8233, 9954, 3017, 4321, 4705, 4568, 9322, 7212, 2781,
        3538, 3433, 4618, 6408, 5042, 4272, 4479, 4561, 9145, 7038, 9454, 9886, 6960, 2080,  2, 4299, 5932, 2033, 9319,
        1533, 8527, 7617,  1, 3765, 7629, 3798, 8809, 8752, 7063, 9974, 8993, 5426, 4644, 7992, 2979, 8209, 5936, 8199,
        721, 3933, 4167, 5373, 5372, 6435, 3195, 57, 5319, 7603, 5820, 2743, 4182, 7485, 5247, 3800, 5753, 1524, 4806,
        740, 7296, 1590, 7395, 1927, 4413, 2739, 7003, 3060, 2343, 7432, 6248, 5328, 381, 2459, 3836, 1831, 8613, 5994,
        1645, 5066, 2012, 54, 5503, 8913, 1225, 6565, 2435, 307, 5642, 3573, 6988, 5343, 5060, 2543, 3213, 9222, 5489,
        987, 5789, 8374, 9579, 9118, 4655, 4703, 591, 5933, 4124, 6462, 5020, 1279, 756, 2206, 8153, 9185, 5973, 9170,
        9428, 1268, 3514, 5478, 3442, 817, 853, 2088, 3233, 6645, 8439, 3154, 4750, 2580, 5893, 4966, 9539, 3092, 1408,
        9361, 2626, 9779, 3083, 1030, 8810, 8393, 493, 8079, 8651, 2062, 1911, 8598, 1139, 5662, 810, 647, 7391, 9406,
        8382, 6840, 5116, 4248, 1513, 1146, 4454, 6856, 7107, 6284, 3938, 8880, 6975, 303, 4648, 3603, 5580, 5361, 6048,
        5213, 6166, 5051, 650, 9946, 1358, 4686, 321, 6912, 3227, 1836, 4626, 3908, 3736, 2107, 7008, 361, 2102, 1315,
        3677, 9927, 6228, 4723, 4351, 2486, 1390, 9331, 66, 7703, 7688, 3888, 5323, 7467, 8918, 5748, 7334, 6413, 8458,
        678, 4935, 3874, 1520, 953, 4755, 4981, 1568, 2504, 8753, 6414, 3380, 6995, 7667, 8786, 684, 4661, 4118, 4772,
        994, 5854, 1381, 7483, 6907, 3768, 9829, 6342, 3163, 6766, 8511, 594, 6921, 3694, 9997, 7820, 8116, 4430, 5771,
        8709, 8165, 1862, 7934, 5856, 9006, 692, 6420, 743, 9152, 559, 8828, 9955, 9092, 5737, 9291, 9792, 6410, 4638,
        1337, 4158, 9054, 5594, 19, 5044, 1614, 2965, 5824, 773, 2140, 9833, 4202, 4597, 9859, 4514, 6082, 8248, 9462,
        425, 9849, 8040, 6354, 9653, 4298, 6164, 9429, 5479, 7556, 6934, 1494, 8484, 9626, 5302, 7907, 704, 4573, 5282,
        5003, 4402, 928, 4936, 81, 3894, 1683, 674, 4799, 1829, 4058, 2938, 1122, 4185, 6490, 5745, 8922, 7165, 6076,
        6056, 9032, 6033, 6629, 3293, 829, 637, 2196, 4471, 8055, 7999, 9840, 1827, 2940, 9358, 3269, 2666, 9915, 204,
        9418, 4815, 7259, 9776, 1747, 7413, 401, 1019, 8585, 4207, 868, 125, 8675, 838, 9549, 4159, 8526, 6023, 586,
        2677, 8088, 7805, 4363, 3182, 8070, 2700, 8342, 5739, 3827, 2901, 8916, 8250, 1461, 2566, 8682, 3248, 8625, 6323,
        7476, 7988, 9387, 3747, 1351, 3668, 6571, 9738, 3112, 2813, 4069, 3659, 3374, 7742, 3467, 1551, 6603, 4025, 6926,
        858, 6880, 1293, 4106, 3663, 8763, 1072, 4893, 2715, 8842, 7144, 77, 6384, 5331, 7434, 5334, 5821, 8998, 6810,
        4586, 4753, 2453, 9712, 2177, 4730, 7698, 9472, 7947, 5130, 5352, 3682, 2925, 8665, 9180, 7766, 9439, 6577, 7146,
        6183, 5440, 509, 1613, 9280, 1084, 8144, 9213, 9481, 3887, 5416, 268, 6967, 1725, 4081, 6843, 9228, 3016, 8895,
        1562, 8441, 2622, 8405, 914, 625, 9753, 3018, 8096, 212, 2698, 6567, 7518, 7187, 8327, 9556, 5326, 3501, 8937,
        3344, 8736, 4930, 1185, 9070, 8712, 6592, 7724, 9565, 3044, 9528, 9123, 5951, 5626, 1276, 4016, 6217, 1004, 5204,
        7854, 4446, 4247, 1404, 9932, 891, 280, 5451, 1550, 4274, 2132, 9639, 2722, 2693, 3699, 9409, 2095, 4584, 6491,
        1904, 909, 7115, 7007, 6783, 532, 7382, 9362, 3186, 5067, 1104, 640, 3283, 8972, 5069, 9377, 8630, 2542, 1023,
        3362, 4336, 2879, 1654, 7658, 5687, 7282, 6563, 4139, 2124, 1810, 2956, 7841, 7271, 452, 4674, 8409, 8636, 9337,
        778, 4476, 4608, 1630, 4972, 8357, 6742, 2836, 1574, 5414, 1164, 1073, 5909, 749, 5877, 5736, 8925, 2194, 6820,
        352, 1942, 4436, 9084, 1261, 5336, 8216, 694, 761, 5724, 6503, 4119, 1946, 4596, 5186, 1788, 9493, 4136, 9967,
        2090, 6947, 9025, 8818, 4416, 18, 6689, 127, 4173, 7157, 9628, 8361, 2632, 7876, 7006, 4317, 5127, 9351, 1534,
        9043, 1929, 8036, 8872, 1369, 7958, 3013, 6020, 4383, 1877, 116, 9217, 4389, 1022, 1437, 6356, 5248, 2960, 9209,
        4308, 5287, 6312, 2902, 7251, 499, 2246, 2878, 7966, 9457, 3237, 5252, 7150, 6031, 1919, 8317, 3481, 2714, 9442,
        8097, 2845, 3904, 7968, 8569, 7553, 3399, 2778, 5797, 6133, 8586, 99, 9316, 1420, 3317, 7487, 4163, 3065, 3350,
        2744, 9939, 8521, 9558, 2702, 4056, 3337, 4214, 8063, 9971, 9684, 3609, 6882, 149, 8101, 2282, 2091, 2759, 9370,
        1197, 3672, 1961, 2098, 2144, 9285, 2732, 1901, 7577, 9804, 9648, 1944, 5735, 9795, 1433, 4668, 8840, 2253, 9912,
        7384, 1001, 1863, 1050, 251, 5138, 2204, 9265, 2310, 8659, 4567, 7429, 4249, 2554, 5229, 8744, 7018, 4306, 2300,
        3552, 6411, 9443, 5419, 6087, 1341, 1222, 5970, 7664, 8657, 7266, 2633, 1977, 6272, 4128, 68, 5632, 7671, 4311,
        2297, 7654, 3869, 5269, 8666,  6, 8639, 82, 4781, 7857, 9348, 6971, 2895, 1086, 6147, 5537, 3612, 5548, 7715,
        2113, 961, 4931, 4864, 1703, 9342, 9880, 7850, 5448, 6558, 2645, 8662, 7583, 95, 4355, 6304, 5135, 213, 2355,
        4823, 2366, 9689, 22, 1468, 3896, 5726, 2588, 4631, 8453, 8093, 8515, 1081, 4721, 2219, 1854, 1111, 515, 7560,
        2922, 3989, 5339, 9986, 2955, 5256, 9102, 5578, 8387, 2382, 9175, 10000, 1602, 9901, 2312, 3967, 4141, 2861,
        1633, 9636, 7524, 1480, 5381, 2978, 1668, 8017, 5475, 9233, 2798, 5255, 8457, 9691, 7131, 4829, 2634, 5322,
        6785, 3327, 8778, 924, 1216, 9582, 5355, 9831, 3806, 3265, 7915, 7465, 2904, 1920, 5785, 459, 5166, 2776, 5108,
        1609, 5582, 9503, 7345, 207, 1577, 3251, 6908, 8352, 6343, 5286, 5498, 101, 5571, 2286, 2432, 4748, 4140, 1558,
        87, 9441, 2959, 4598, 4920, 6212, 124, 6392, 3944, 9465, 7711, 5765, 9627, 2202, 1897, 2511, 1318, 7752, 1670,
        1326, 2770, 6113, 2571, 9071, 9511, 5779, 9251, 4178, 4408, 2108, 6159, 6608, 3196, 4253, 9887, 2135, 246, 9125,
        3622, 3411, 1650, 4782, 919, 837, 6278, 6402, 7206, 8635, 1971, 2713, 7978, 1799, 9853, 4927, 4915, 1937, 4969,
        6382, 2110, 114, 4325, 8663, 4734, 4238, 737, 5104, 5738, 1951, 9287, 3430, 7598, 998, 4576, 4358, 6465, 6455
    };

    [Benchmark]
    public void ReverseList() => ReverseLinkedList.ReverseList( ListNode.Create( Input ) );

    [Benchmark]
    public void ReverseListIteratively() => ReverseLinkedList.ReverseListIteratively( ListNode.Create( Input ) );

    [Benchmark]
    public void ReverseListRightWay() => ReverseLinkedList.ReverseListRightWay( ListNode.Create( Input ) );
}
